#
# This is a magic(5) data file for OCCRP's DataSurvey.
#
# Parts of this file extracted from 'file' database
#

# Cronos databases
0	string	CroFile\0				Cronos Database File
!:mime	application/x-cronos-db

0	string	CroStru\0				Cronos Database File
!:mime	application/x-cronos-structure

# gzip (GNU zip, not to be confused with Info-ZIP or PKWARE zip archiver)
#   Edited by Chris Chittleborough <cchittleborough@yahoo.com.au>, March 2002
#	* Original filename is only at offset 10 if "extra field" absent
#	* Produce shorter output - notably, only report compression methods
#         other than 8 ("deflate", the only method defined in RFC 1952).
0       string          \037\213        gzip compressed data
!:mime	application/x-gzip
!:strength * 2

# bzip2
0	string		BZh		bzip2 compressed data
!:mime	application/x-bzip2
>3	byte		>47		\b, block size = %c00k

# 7-zip archiver, from Thomas Klausner (wiz@danbala.tuwien.ac.at)
# http://www.7-zip.org or DOC/7zFormat.txt
#
0	string		7z\274\257\047\034	7-zip archive data,
>6	byte		x			version %d
>7	byte		x			\b.%d
!:mime	application/x-7z-compressed


# RAR (Roshal Archive) archive
0	string		Rar!\x1a\7\0		RAR archive data
!:mime	application/x-rar

0	string		Rar!\x1a\7\1\0		RAR archive data, v5
!:mime	application/x-rar

# Very old RAR archive
# http://jasonblanks.com/wp-includes/images/papers/KnowyourarchiveRAR.pdf
0	string		RE\x7e\x5e  RAR archive data (<v1.5)
!:mime	application/x-rar

# PKZIP multi-volume archive
0	string	PK\x07\x08PK\x03\x04	Zip multi-volume archive data, at least PKZIP v2.50 to extract
!:mime	application/zip

# Zip archives (Greg Roelofs, c/o zip-bugs@wkuvx1.wku.edu)
0	string	PK\005\006	Zip archive data (empty)
!:mime application/zip

0	string	PK\003\004
# Generic zip archives (Greg Roelofs, c/o zip-bugs@wkuvx1.wku.edu)
#   Next line excludes specialized formats:
>(26.s+30)	leshort	!0xcafe
>>26    string          !\x8\0\0\0mimetype	Zip archive data
!:mime application/zip


# CSV, TSV
0	regex	((["']{0,1})(.*)["']{0,1}[,])+	 	CSV File, Comma Separated
!:mime  text/csv

0	regex	((["']{0,1})(.*)["']{0,1}[;])+	 	CSV File, Semicolon Separated
!:mime	text/csv

0	regex	((["']{0,1})(.*)["']{0,1}[\|])+ 	CSV File, Pipe Separated
!:mime	text/csv

0	regex	((["']{0,1})(.*)["']{0,1}[\t])+ 	TSV File
!:mime	text/tsv

# Scripts
0	string #!		
>2	string /usr/bin/python  			Python Script
!:mime	application/x-python
>2	string /bin/bash				Bash Script
!:mime	application/x-bash

